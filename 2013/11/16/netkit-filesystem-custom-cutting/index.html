<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Cyanny Liang" />



<meta name="description" content="Netkit, “The poor man’s system for experimenting computer networking”，是基于Linux的开源网络实验环境，该环境通过启动多台Linux虚拟机，模拟路由器，交换机和PC的网络通信功能，Netkit中预装了路由协议软件包Quagga,可以提供多种路由协议功能，如RIP， OSPF， BGP，IS-IS等，Netkit主要用于网络功能">
<meta property="og:type" content="article">
<meta property="og:title" content="Netkit Filesystem 定制和裁剪">
<meta property="og:url" content="http://www.cyanny.com/2013/11/16/netkit-filesystem-custom-cutting/index.html">
<meta property="og:site_name" content="CyannyLive">
<meta property="og:description" content="Netkit, “The poor man’s system for experimenting computer networking”，是基于Linux的开源网络实验环境，该环境通过启动多台Linux虚拟机，模拟路由器，交换机和PC的网络通信功能，Netkit中预装了路由协议软件包Quagga,可以提供多种路由协议功能，如RIP， OSPF， BGP，IS-IS等，Netkit主要用于网络功能">
<meta property="og:image" content="http://cyanny/myblog/wp-content/uploads/2013/11/netkit-580x393.png">
<meta property="og:updated_time" content="2016-09-27T01:03:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Netkit Filesystem 定制和裁剪">
<meta name="twitter:description" content="Netkit, “The poor man’s system for experimenting computer networking”，是基于Linux的开源网络实验环境，该环境通过启动多台Linux虚拟机，模拟路由器，交换机和PC的网络通信功能，Netkit中预装了路由协议软件包Quagga,可以提供多种路由协议功能，如RIP， OSPF， BGP，IS-IS等，Netkit主要用于网络功能">
<meta name="twitter:image" content="http://cyanny/myblog/wp-content/uploads/2013/11/netkit-580x393.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="CyannyLive" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Netkit Filesystem 定制和裁剪 | CyannyLive</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Cyanny Liang</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">Home</a></li>
                        
                            <li><a href="/archives/">All Blogs</a></li>
                        
                            <li><a href="/tags/">Tags</a></li>
                        
                            <li><a href="/about/">About</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="/lgrcyanny@gmail.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" href="http://www.weibo.com/1981511992" title="新浪微博"></a>
                            
                                <a class="fa GitHub" href="https://github.com/lgrcyanny" title="GitHub"></a>
                            
                                <a class="fa Twitter" href="https://twitter.com/lgrcyanny" title="Twitter"></a>
                            
                                <a class="fa Facebook" href="https://www.facebook.com/CyannyLIANG" title="Facebook"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/agile/">Agile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/akka/">Akka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/big-data/">Big Data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coursera/">Coursera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design/">Design</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/">HBase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hive/">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/language/">Language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/">Learn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learning/">Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mapreduce/">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/methodology/">Methodology</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">Network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/research/">Research</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource/">Resource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">Scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrum/">Scrum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/systemanalysis/">SystemAnalysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vps/">VPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learning/">learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sort/">sort</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/诗话/">诗话</a></li></ul>
                    </div>
                </section>
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">Big Data, Spark and AI</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Cyanny Liang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Cyanny Liang</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">Home</a></li>
                
                    <li><a href="/archives/">All Blogs</a></li>
                
                    <li><a href="/tags/">Tags</a></li>
                
                    <li><a href="/about/">About</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="/lgrcyanny@gmail.com" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://www.weibo.com/1981511992" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/lgrcyanny" title="GitHub"></a>
                            
                                <a class="fa Twitter" target="_blank" href="https://twitter.com/lgrcyanny" title="Twitter"></a>
                            
                                <a class="fa Facebook" target="_blank" href="https://www.facebook.com/CyannyLIANG" title="Facebook"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-netkit-filesystem-custom-cutting" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2013/11/16/netkit-filesystem-custom-cutting/" class="article-date">
      <time datetime="2013-11-16T10:42:51.000Z" itemprop="datePublished">2013-11-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Netkit Filesystem 定制和裁剪
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/network/">Network</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/network/">Network</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Netkit, “The poor man’s system for experimenting computer networking”，是基于Linux的开源网络实验环境，该环境通过启动多台Linux虚拟机，模拟路由器，交换机和PC的网络通信功能，Netkit中预装了路由协议软件包Quagga,可以提供多种路由协议功能，如RIP， OSPF， BGP，IS-IS等，Netkit主要用于网络功能的模拟，而不做网络性能的模拟。</p>
<p>最近花了一周的时间实验Netkit，是网络的大作业，如果不是作业的机会，也不会有空去看这么古老的Netkit，他是北欧开发的一个开源网络实验环境，相比Packet Tracer美观的图形界面，对于没有图形界面的Netkit来说，Netkit的优势在于提供了用户模式的Linux内核，每一个虚拟机就是一个Linux系统，可以更真实地模拟路由等网络功能，用户通过命令行操作虚拟机，能更好地学习和实验网络，而不是学习一个Cisco设备。如果有朋友以后用到Netkit，希望这个Blog会helpful。</p>
<p>Netkit主要由三部分构成：</p>
<ul>
<li>netkit-core: 包含启动虚拟机和网络实验的脚本文件，如vstart，lstart等。</li>
<li>netkit-uml-filesystem: 这是一个基于Debian的文件系统，Netkit在该文件系统中安装了软件包，并配置了quagga，ebtables, iptables等服务。Netkit的文件系统是“copy-on-write”的模式，每个虚拟机启动时会生成一个<em>.disk文件，该文件就是该文件系统的拷贝，在虚拟机中作的任何更改都不会影响Netkit的Filesystem，修改写入</em>.disk文件.</li>
<li>netkit-uml-kernel: 这是一个linux kernel， Netkit通过patch文件对kernel进行了相关配置，Netkit的kernel是用户模式的linux进程，也叫做虚拟机,我们可以在Linux系统如Ubuntu中启动netkit，kernel进程的运行依赖于文件系统。<br>我们发现Netkit的文件系统解压后超过10GB，每次启动一个虚拟机就会产生一个10GB的*.disk文件，占用空间较大，我们主要使用Netkit的Quagga进行路由协议的模拟，而Netkit很强大，提供了apache, FTP, openssl,openvpn, DNS, email等功能，我们不需要这些冗余功能，因此我们着手重新制作一个文件系统，并尽量让文件系统容量小，提高Netkit网络实验的性能。</li>
</ul>
<p>Netkit官方提供了Makefile文件让开发者自己Build文件系统，然而实验后发现官方Makefile无法运行通过，并且Netkit官方指南中并不建议自己Build一个文件系统，在Google后也没有发现更多有用的文档，因此希望通过本Blog详细地描述如何制作一个小巧可用的Netkit文件系统以及遇到的问题。 [more…]</p>
<h2 id="实验成果"><a href="#实验成果" class="headerlink" title="实验成果"></a>实验成果</h2><p>最终定制和裁剪的文件系统只有335M，该文件系统基于Debian Squeeze版本定制，没有采用当前的最新版本Wheezy版，因为并不修改Netkit-Kernel，最新版的Wheezy文件系统和现有的Netkit Kernel不兼容。</p>
<p>该文件系统的制作简单来说，分为三个阶段：制作基础的linux filesystem， 配置为可用的Netkit文件系统，安装quagga和必要的软件包。这些步骤都是通过shell命令来完成的。</p>
<p>你可能会问，为什么是335M？我们最早制作的文件系统是2GB，在运行稳定后，我们发现2GB是稀疏文件，在虚拟机中通过df命令我们看到磁盘空间只占用了310M，在基础的Linux文件系统安装好后，磁盘占用空间在250M左右，而我们安装了less,vim,chkconfig,quagga,telnet, telnetd, tcptraceroute这7个必要的包后，磁盘占用空间为310M+，因此我们取文件系统320M来制作，在制作完成后，大小为335M。</p>
<p>最终制作和裁剪的文件系统通过了静态路由，RIP， OSPF Single Area, OSPF Multi Area, BGP的测试。</p>
<p>定制文件系统的源代码在：<a href="https://github.com/lgrcyanny/NetkitNewFS" target="_blank" rel="external">NetkitNewFS</a></p>
<p>测试的实验拓扑文件在：<a href="https://github.com/lgrcyanny/NetkitLabs" target="_blank" rel="external">NetkitLabs</a></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>1. Ubuntu 32位环境或虚拟机</p>
<p>Netkit是基于32bit的Linux系统编译的，建议在32bit环境下运行，64Bit的机器安装会缺一些lib包，让工作更加麻烦.</p>
<p>2. 安装Netkit</p>
<p>其次，安装Netkit，参见<a href="http://wiki.netkit.org/index.php/Main_Page" target="_blank" rel="external">官方网站</a>，安装很简单，解压+配置环境变量。</p>
<p>也可以看<a href="https://github.com/lgrcyanny/NetkitNewFS" target="_blank" rel="external">NetkitNewFS</a>源码下的README，有安装方法。</p>
<h2 id="定制流程"><a href="#定制流程" class="headerlink" title="定制流程"></a>定制流程</h2><p>整个定制过程大体可以分为三歩：制作基础的Linux内核文件系统，修改文件系统为可用的Netkit文件系统，为文件系统安装Quagga。下面让我们按照这个顺序来看看整个定制流程。</p>
<h3 id="step1-制作基础的Linux内核文件系统："><a href="#step1-制作基础的Linux内核文件系统：" class="headerlink" title="step1.制作基础的Linux内核文件系统："></a>step1.制作基础的Linux内核文件系统：</h3><p>我们直接写一个bash脚本来完成第一步制作基础的Linux内核的文件系统的工作，完整的脚本内容如下：</p>
<p>脚本不长(<a href="https://github.com/lgrcyanny/NetkitNewFS/blob/master/netkit-fs-build.sh" target="_blank" rel="external">netkit-fs-build.sh</a>)<br>[bash]</p>
<p>#!/bin/bash<br>echo &quot;====================Installing Base Linux System======================&quot;<br>FS_NAME=netkit-fs-light<br>MOUNT_DIR=/mnt/nkfs2<br>FILESYSTEM_SIZE=320</p>
<h1 id="each-cylinder-has-63-sectors-each-of-which-is-512-bytes"><a href="#each-cylinder-has-63-sectors-each-of-which-is-512-bytes" class="headerlink" title="each cylinder has 63 sectors, each of which is 512 bytes"></a>each cylinder has 63 sectors, each of which is 512 bytes</h1><p>let CYL_COUNT=$FILESYSTEM_SIZE*1048576/32256</p>
<h1 id="Create-empty-netkit-fs-file"><a href="#Create-empty-netkit-fs-file" class="headerlink" title="Create empty netkit-fs file"></a>Create empty netkit-fs file</h1><p>dd if=/dev/zero of=$FS_NAME bs=1M count=0 seek=$FILESYSTEM_SIZE</p>
<h1 id="Create-image-partition"><a href="#Create-image-partition" class="headerlink" title="Create image partition"></a>Create image partition</h1><p>echo &quot;,,L,*&quot; | sfdisk -q -H 1 -S 63 -C $CYL_COUNT $FS_NAME</p>
<h1 id="Binding-lookback-device-to-netkit-fs"><a href="#Binding-lookback-device-to-netkit-fs" class="headerlink" title="Binding lookback device to netkit-fs"></a>Binding lookback device to netkit-fs</h1><p>device_name=$(losetup -f)</p>
<h1 id="The-offset-is-the-size-of-one-track"><a href="#The-offset-is-the-size-of-one-track" class="headerlink" title="The offset is the size of one track"></a>The offset is the size of one track</h1><p>losetup –offset 512 $device_name $FS_NAME</p>
<h1 id="Create-ext2-filesystem"><a href="#Create-ext2-filesystem" class="headerlink" title="Create ext2 filesystem"></a>Create ext2 filesystem</h1><p>mkfs.ext2 $device_name<br>losetup -d $device_name</p>
<h1 id="Mount-netkit-fs"><a href="#Mount-netkit-fs" class="headerlink" title="Mount netkit-fs"></a>Mount netkit-fs</h1><p>rm -rf $MOUNT_DIR<br>mkdir $MOUNT_DIR<br>mount -o loop,offset=512 -t ext2 $FS_NAME $MOUNT_DIR</p>
<h1 id="Install-the-base-filesystem-from-Internet"><a href="#Install-the-base-filesystem-from-Internet" class="headerlink" title="Install the base filesystem  from Internet"></a>Install the base filesystem  from Internet</h1><p>debootstrap –arch i386 squeeze $MOUNT_DIR <a href="http://ftp.cn.debian.org/debian" target="_blank" rel="external">http://ftp.cn.debian.org/debian</a><br>echo &quot;=================Base Linux System Installed Success==================&quot;</p>
<p>umount $MOUNT_DIR<br>echo &quot;done!&quot;<br>[/bash]<br>脚本的功能是创建一个320M的文件，采用sfdisk创建Linux分区表，绑定到环回设备上创建ext2文件系统，在mount到主机的/mnt/nkfs2下，通过debootstrap命令联网联网下载并安装Linux Squeeze 文件系统。具体每一歩，在脚本注释中。<br>值得注意的是，脚本的最后部分，即命令：<br>[bash]<br>debootstrap –arch i386 squeeze $MOUNT_DIR <a href="http://ftp.cn.debian.org/debian" target="_blank" rel="external">http://ftp.cn.debian.org/debian</a><br>[/bash]<br>需要通过联网安装debian squeeze内核，该文件系统下载解压后只有200多兆，选择squeeze主要是为了和netkit-kernel兼容。<br>保存脚本文件，比如存为netkit-fs-build.sh，打开终端，cd到脚本文件所在目录下，使用命令：<br>[bash]<br>sudo sh netkit-fs-build.sh<br>[/bash]<br>运行脚本（注意使用root权限），即可得到基础的Linux文件系统了。</p>
<h3 id="step2-修改文件系统为可用的Netkit文件系统："><a href="#step2-修改文件系统为可用的Netkit文件系统：" class="headerlink" title="step2.修改文件系统为可用的Netkit文件系统："></a>step2.修改文件系统为可用的Netkit文件系统：</h3><h4 id="1-从Netkit原始文件系统中拷贝必要的文件，并修改netkit-phase1和netkit-phase2"><a href="#1-从Netkit原始文件系统中拷贝必要的文件，并修改netkit-phase1和netkit-phase2" class="headerlink" title="1. 从Netkit原始文件系统中拷贝必要的文件，并修改netkit-phase1和netkit-phase2"></a>1. 从Netkit原始文件系统中拷贝必要的文件，并修改netkit-phase1和netkit-phase2</h4><p>上一步得到的文件系统，并不可以直接用于Netkit，启动虚拟机会失败，需要用到Netkit原始的文件系统中的部分文件进行补充，将其配置成可用的Netkit FileSystem。<br>所有需要添加到自制文件系统中的Netkit原始文件系统中的文件我们把他们放在了<a href="https://github.com/lgrcyanny/NetkitNewFS/tree/master/netkit-tweaks" target="_blank" rel="external">netkit-tweaks</a>文件夹下，其目录结构如下，各自作用见注释：<br>[text]<br>netkit-tweaks<br>—- etc<br>———init.d #contains netkit-phase1 and netkit-phase2, the two important file for netkit bootstrap<br>———network #interfaces configure<br>———inittab # inittab file for bootstrap runlevel<br>———resolv.conf # DNS parse<br>———sysctl.conf # net.ipv4.ip_forward=1 for ip forwarding, important configure, enable ip packet forwarding<br>—–sbin<br>———mingetty # mingetty is a minimal getty program for watching virtual termianl<br>[/text]</p>
<p>该文件夹下所有的文件都可以在Netkit原始文件系统下找到，可以通过挂载原始文件系统把他们从挂载地址拷贝出来，其中/mnt/nkfs1为自定义的挂载地址：<br>[bash]<br>mount -o loop,offset=32768 netkit-fs-i386-F5.2 /mnt/nkfs1<br>[/bash]<br>文件netkit-phase1和netkit-phase2需要稍作修改， 修改netkit-phase1中开头部分为：<br>[bash]</p>
<h3 id="BEGIN-INIT-INFO"><a href="#BEGIN-INIT-INFO" class="headerlink" title="BEGIN INIT INFO"></a>BEGIN INIT INFO</h3><h1 id="Provides"><a href="#Provides" class="headerlink" title="Provides:"></a>Provides:</h1><h1 id="Required-Start"><a href="#Required-Start" class="headerlink" title="Required-Start:"></a>Required-Start:</h1><h1 id="Required-Stop-all"><a href="#Required-Stop-all" class="headerlink" title="Required-Stop: $all"></a>Required-Stop: $all</h1><h1 id="Default-Start-2-3-4-5"><a href="#Default-Start-2-3-4-5" class="headerlink" title="Default-Start: 2 3 4 5"></a>Default-Start: 2 3 4 5</h1><h1 id="Default-Stop-0-1-6"><a href="#Default-Stop-0-1-6" class="headerlink" title="Default-Stop: 0 1 6"></a>Default-Stop: 0 1 6</h1><h1 id="Short-Description"><a href="#Short-Description" class="headerlink" title="Short-Description:"></a>Short-Description:</h1><h1 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h1><h3 id="END-INIT-INFO"><a href="#END-INIT-INFO" class="headerlink" title="END INIT INFO"></a>END INIT INFO</h3><p>[/bash]</p>
<p>修改netkit-phase2中开头部分为：<br>[bash]</p>
<h3 id="BEGIN-INIT-INFO-1"><a href="#BEGIN-INIT-INFO-1" class="headerlink" title="BEGIN INIT INFO"></a>BEGIN INIT INFO</h3><h1 id="Provides-1"><a href="#Provides-1" class="headerlink" title="Provides:"></a>Provides:</h1><h1 id="Required-Start-all"><a href="#Required-Start-all" class="headerlink" title="Required-Start: $all"></a>Required-Start: $all</h1><h1 id="Required-Stop"><a href="#Required-Stop" class="headerlink" title="Required-Stop:"></a>Required-Stop:</h1><h1 id="Default-Start-2-3-4-5-1"><a href="#Default-Start-2-3-4-5-1" class="headerlink" title="Default-Start: 2 3 4 5"></a>Default-Start: 2 3 4 5</h1><h1 id="Default-Stop-0-1-6-1"><a href="#Default-Stop-0-1-6-1" class="headerlink" title="Default-Stop: 0 1 6"></a>Default-Stop: 0 1 6</h1><h1 id="Short-Description-1"><a href="#Short-Description-1" class="headerlink" title="Short-Description:"></a>Short-Description:</h1><h1 id="Description-1"><a href="#Description-1" class="headerlink" title="Description:"></a>Description:</h1><h3 id="END-INIT-INFO-1"><a href="#END-INIT-INFO-1" class="headerlink" title="END INIT INFO"></a>END INIT INFO</h3><p>[/bash]<br>$all的意思是最后，在netkit-phase1中表示最后停止，在netkit-phase2中表示最后开始，这是启动优先级的配置。<br>同时在netkit-phase2中，并将文件中/bin/sh -c ‘source /hostlab/$HOSTNAME.startup’这种类似的语句修改为”source /hostlab/$HOSTNAME.startup”。<br>因为用/bin/sh启动 startup脚本会会报”/bin/sh: source not found”的错误，默认用bash启动startup脚本就不会报错。<br>至此，所有需要添加进自制文件系统的文件已经全部在netkit-tweaks文件夹中了。</p>
<h4 id="2-拷贝必要的文件到文件系统中"><a href="#2-拷贝必要的文件到文件系统中" class="headerlink" title="2. 拷贝必要的文件到文件系统中"></a>2. 拷贝必要的文件到文件系统中</h4><p>首先挂载刚刚创建的文件系统netkit-fs-light：<br>[bash]<br>FS_NAME=netkit-fs-light<br>NETKIT_TWEAKS_DIR=netkit-tweaks<br>MOUNT_DIR=/mnt/nkfs2<br>mount -o loop,offset=512 -t ext2 $FS_NAME $MOUNT_DIR<br>[/bash]<br>下面需要把一些必要的文件拷贝到自制的文件系统中，其中<strong>/etc/sysctl.conf</strong>文件很重要，作用是将ipv4.ip_forward设为1，否则虚拟机无法ping通：<br>[bash]<br>cp -Rvf $NETKIT_TWEAKS_DIR/etc $MOUNT_DIR/<br>cp -Rvf $NETKIT_TWEAKS_DIR/sbin $MOUNT_DIR/<br>[/bash]</p>
<h4 id="3-改变root根目录位置，准备安装必要的工具和软件"><a href="#3-改变root根目录位置，准备安装必要的工具和软件" class="headerlink" title="3. 改变root根目录位置，准备安装必要的工具和软件"></a>3. 改变root根目录位置，准备安装必要的工具和软件</h4><p>改变root的执行程序参考的根目录位置至挂载文件系统的位置，方便我们直接配置文件系统和使用文件系统中的命令：<br>[bash]<br>chroot $MOUNT_DIR<br>[/bash]<br>挂载proc文件系统，proc文件系统是提供Linux内核数据结构接口的伪文件系统，文件系统并没有挂载proc文件系统，proc文件系统一般挂载在/proc目录下，如果没有挂载，虚拟机启动时会出现mtab无法初始化错误，也就是mtab文件会被损坏，因此我们为了让文件系统更完善，增加挂载proc文件系统的命令。<br>[bash]<br>mount -t proc none /proc<br>[/bash]</p>
<h4 id="4-安装必要的软件包"><a href="#4-安装必要的软件包" class="headerlink" title="4. 安装必要的软件包"></a>4. 安装必要的软件包</h4><p>紧接着为文件系统更新和安装一些必要的工具和软件：<br>[bash]<br>apt-get update<br>apt-get install less<br>apt-get install vim<br>apt-get install chkconfig #为设置netkit-phase文件的启动优先级<br>[/bash]</p>
<h4 id="5-设置netkit-phase1和netkit-phase2脚本的启动优先级"><a href="#5-设置netkit-phase1和netkit-phase2脚本的启动优先级" class="headerlink" title="5. 设置netkit-phase1和netkit-phase2脚本的启动优先级"></a>5. 设置netkit-phase1和netkit-phase2脚本的启动优先级</h4><p>在Debian 6.0之后，不能采用update-rc.d命令设置init.d目录下启动文件的优先级，采用insserv命令可以简单设置。我们尝试过将rcX.d文件从原始netkit文件系统中拷贝到新的文件系统中，发现不能使用，rcX.d这些链接文件是需要通过命令来生成的。在原始的netkit Makefile中采用update-rc.d设置是不成功的，采用insserv是我们做出的改进。<br>将netkit-phase1和netkit-phase2链接到rcX.d并设置优先级：<br>[bash]<br>insserv netkit-phase1<br>chkconfig netkit-phase1 on<br>insserv netkit-phase2<br>chkconfig netkit-phase2 on<br>[/bash]</p>
<h4 id="6-禁止不必要的启动项，取消挂载"><a href="#6-禁止不必要的启动项，取消挂载" class="headerlink" title="6. 禁止不必要的启动项，取消挂载"></a>6. 禁止不必要的启动项，取消挂载</h4><p>取消cron job的启动项，加快启动<br>[bash]<br>update-rc.d cron remove<br>[/bash]<br>最后退出并取消挂载：<br>[bash]<br>exit # 退出新文件系统的根目录环境，回到ubunu根目录环境下<br>umount $MOUNT_DIR/proc<br>umount $MOUNT_DIR<br>[/bash]<br>如果因为设备正忙而无法取消挂载，可以察看相应进程，先杀死进程再取消挂载：<br>[bash]<br>fuser -m $MOUNT_DIR</p>
<h1 id="if-out-put-is-dev-sdc1-538"><a href="#if-out-put-is-dev-sdc1-538" class="headerlink" title="if out put is /dev/sdc1: 538"></a>if out put is /dev/sdc1: 538</h1><p>ps -aux | grep 538</p>
<h1 id="then-kill-the-process-by-proccess-id"><a href="#then-kill-the-process-by-proccess-id" class="headerlink" title="then kill the process by proccess id"></a>then kill the process by proccess id</h1><p>[/bash]</p>
<h3 id="step3-为文件系统安装quagga："><a href="#step3-为文件系统安装quagga：" class="headerlink" title="step3.为文件系统安装quagga："></a>step3.为文件系统安装quagga：</h3><p>以上两步都是在Ubuntu主机下运行的，现在我们自制的Netkit FileSystem应该可以正常启动虚拟机了，最后一步需要启动虚拟机并在虚拟机内安装quagga。<br>首先启动Netkit虚拟机：<br>[bash]<br>FS_NAME=netkit-fs-light<br>vstart pc1 -m $FS_NAME -M 512 –eth0=tap,10.0.0.1,10.0.0.2 –append=rout:98:1 –W<br>[/bash]<br>该命令中参数解释如下：<br>–m $FS_NAME 表示以指定的文件系统作为虚拟机的文件系统<br>-M 512 指定内存512M，以为要联网安装，所以不能用默认的32M内存，太小<br>–eth0=tap,10.0.0.1,10.0.0.2 绑定eth0网卡到tap碰撞域，tap碰撞域是netkit保留的碰撞域，通过tap可以连接主机上外部因特网，10.0.0.1是TAP-ADDRESS是在Tap碰撞域中分配给主机Ubuntu的地址，10.0.0.2是GUEST-ADDRESS是分配给虚拟机的地址，此时可以ping任意的因特网，如baidu.com是可以成功的。<br>–append=rout:98:1 为netkit-kernel提供的参数<br>-W 表示对虚拟机的修改就是对Netkit文件系统的修改，不产生*.disk文件<br>启动后的虚拟机如图：<br><a href="http://cyanny/myblog/wp-content/uploads/2013/11/netkit.png" target="_blank" rel="external"><img src="http://cyanny/myblog/wp-content/uploads/2013/11/netkit-580x393.png" alt="netkit"></a><br>接下来在虚拟机中安装必要软件和工具：<br>[bash]<br>apt-get install telnet<br>apt-get install telnetd<br>apt-get install tcptraceroute<br>[/bash]<br>接着安装quagga，注意安装的quagga 版本为0.99.20.1，太高的版本可能会因为与内核版本不兼容：<br>[bash]<br>apt-cache policy quagga # 查看quagga可安装的版本，默认就有 0.99.20.1版本<br>apt-get install quagga -v 0.99.20.1<br>[/bash]<br>察看占用空间，最后退出虚拟机:<br>[bash]<br>dh -lf  # 320M is the smallest solution, since up to now, 310M has been used<br>halt<br>[/bash]<br>至此，我们的文件系统就制作成功了，以上step2和step3的脚本，请参考<a href="https://github.com/lgrcyanny/NetkitNewFS/blob/master/configure-netkit.sh" target="_blank" rel="external">configure-netkit.sh</a>，我采用的是手工配置，一方面命令不多，另一方面手工配置可以保证每一步的正确性。通过查看文件系统的信息我们看到文件系统为335M左右。<br>使用这一自制文件系统，我们通过了rip, ospf single area, ospf multi area和simple bgp的网络实验测试。Netkit lab实验在官方网站中有详细的教程，在此就不详细描述实验了，能做出这个文件系统，我表示很欣慰，同时也学习到文件系统的制作是通过shell命令完成，开始以为需要C方面的知识。</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>在实验中，遇到了很多问题，这些问题对定制该文件系统有很大价值，在此做一个记录和说明，如果遇到相似的问题，可以参考。</p>
<h3 id="1-虚拟机启动闪退"><a href="#1-虚拟机启动闪退" class="headerlink" title="1. 虚拟机启动闪退"></a>1. 虚拟机启动闪退</h3><p>我们在做netkit文件系统时，有三个组员出现了启动虚拟机闪退的问题，我们为此花费了很多时间，的解决方法如下：<br>1.检查基础Linux文件系统是否安装成功，之前是因为文件系统的分区就没有创建成功，造成debootstrap也没有成功，文件没有安装好，启动闪退。<br>2.基础文件系统安装好了，拷贝了netkit-phaseX等文件后，启动虚拟机闪退，这是因为netkit-phaseX文件没有设置好优先级，需要在Ubuntu主机中通过insserv和chkconfig设置优先级。方可启动不闪退。</p>
<h3 id="2-Quagga安装失败"><a href="#2-Quagga安装失败" class="headerlink" title="2. Quagga安装失败"></a>2. Quagga安装失败</h3><p>我尝试过在Ubuntu中，通过chroot后，在文件系统中安装quagga，此时安装的quagga的版本不是0.99.20.1版，安装失败，之后又在虚拟机种通过手工编译安装quagga，依然失败。<br>最后的解决方法是，在虚拟机中，采用apt-get install quagga –v 0.99.20.1安装，-v指定版本，quagga的安装需要依赖netkit提供的内核，在ubuntu安装是没有netkit内核的，造成不能使用。</p>
<h3 id="3-IP-Forwarding问题"><a href="#3-IP-Forwarding问题" class="headerlink" title="3. IP Forwarding问题"></a>3. IP Forwarding问题</h3><p>Quagga安装成功后，lab可以启动了，路由可以学习到路由，但是不能ping通，纠结一阵之后，我们发现是ip forward在Linux中默认关闭了，打开就可以。因此从原netkit文件系统中拷贝sysctl.conf文件，该文件可以永久设定net.ipv4.ip_forward=1，这样ip forward在启动时就已经打开，虚拟机之间就可以ping通了。</p>
<h3 id="4-Fedora-x64下配置虚拟机和配更改文件系统的问题-from-Aqua"><a href="#4-Fedora-x64下配置虚拟机和配更改文件系统的问题-from-Aqua" class="headerlink" title="4. Fedora- x64下配置虚拟机和配更改文件系统的问题(from Aqua)"></a>4. Fedora- x64下配置虚拟机和配更改文件系统的问题(from Aqua)</h3><p>在Ubuntu系统中配置完成实验之后，我们尝试了在64位Fedora系统中配置Netkit虚拟机。由于Netkit是基于32位系统编译，所以要首先解决64位系统中的不同函数库的依赖问题。在Debian系统中，解决32位函数库依赖只需要apt-get ia32-libs即可。但是在Fedora的yum系统中，并不存在这个名称的包。经验证，如下命令解决问题。<br>[bash]<br>su -c ‘yum -y install –skip-broken glibc.i686 arts.i686 audiofile.i686 bzip2-libs.i686 cairo.i686 cyrus-sasl-lib.i686 dbus-libs.i686 directfb.i686 esound-libs.i686 fltk.i686 freeglut.i686 gtk2.i686 hal-libs.i686 imlib.i686 lcms-libs.i686 lesstif.i686 libacl.i686 libao.i686 libattr.i686 libcap.i686 libdrm.i686 libexif.i686 libgnomecanvas.i686 libICE.i686 libieee1284.i686 libsigc++20.i686 libSM.i686 libtool-ltdl.i686 libusb.i686 libwmf.i686 libwmf-lite.i686 libX11.i686 libXau.i686 libXaw.i686 libXcomposite.i686 libXdamage.i686 libXdmcp.i686 libXext.i686 libXfixes.i686 libxkbfile.i686 libxml2.i686 libXmu.i686 libXp.i686 libXpm.i686 libXScrnSaver.i686 libxslt.i686 libXt.i686 libXtst.i686 libXv.i686 libXxf86vm.i686 lzo.i686 mesa-libGL.i686 mesa-libGLU.i686 nas-libs.i686 nss_ldap.i686 cdk.i686 openldap.i686 pam.i686 popt.i686 pulseaudio-libs.i686 sane-backends-libs-gphoto2.i686 sane-backends-libs.i686 SDL.i686 svgalib.i686 unixODBC.i686 zlib.i686 compat-expat1.i686 compat-libstdc++-33.i686 openal-soft.i686 alsa-oss-libs.i686 redhat-lsb.i686 alsa-plugins-pulseaudio.i686 alsa-plugins-oss.i686 alsa-lib.i686 nspluginwrapper.i686 libXv.i686 libXScrnSaver.i686 qt.i686 qt-x11.i686 pulseaudio-libs.i686 pulseaudio-libs-glib2.i686 alsa-plugins-pulseaudio.i686’<br>[/bash]<br>这个长命令涵盖了ia32-libs中包含的所有依赖文件。<br>但是在生成文件系统过程中，由于Debian的Debootstrap并不能很好的兼容Fedora系统，导致生成文件系统失败。尚未找到更好的解决方案。<br>在Fedora下的尝试不成功，这也就是我们选取Ubuntu的原因，Netkit是32bitDebian系统，在32bitDebian系统下编译会更好。</p>
<h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><p>[1] <a href="http://wiki.netkit.org/index.php/Main_Page" target="_blank" rel="external">Netkit官方网站</a><br>[2] <a href="http://wiki.netkit.org/index.php/FAQ#How_can_I_build_a_custom_kernel.2Ffilesystem_from_scratch_for_use_with_Netkit.3F" target="_blank" rel="external">Netkit官方FAQ</a><br>[3] <a href="http://wiki.netkit.org/index.php/Labs_Official" target="_blank" rel="external">Netkit 官方实验和介绍</a><br>[4] <a href="http://list.dia.uniroma3.it/pipermail/netkit.users/2007-October/000271.html" target="_blank" rel="external">Netkit用户问答</a><br>[5] <a href="http://www.debian.org/releases/" target="_blank" rel="external">Debian内核release介绍</a><br>[6] <a href="http://www.linux.com/news/enterprise/systems-management/8116-an-introduction-to-services-runlevels-and-rcd-scripts" target="_blank" rel="external">An introduction to services, runlevels, and rc.d scripts</a><br>[7] <a href="http://opensourcecentre.wordpress.com/article/install-quagga-as-linux-router/" target="_blank" rel="external">Install quagga as linux router</a><br>[8] <a href="http://openmaniak.com/quagga_tutorial.php#ip_forwarding" target="_blank" rel="external">Quagga Tutorial for ip forwarding</a><br>[9] <a href="http://ocaoimh.ie/2008/02/13/how-to-umount-when-the-device-is-busy/" target="_blank" rel="external">How to umount when device is busy</a></p>

      
    </div>
    
  </div>
  
    


    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2013/11/24/distributed-system-review-part1/">
                    分布式系统总结part1
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2013/11/13/ipsec-architecture/">
                    IPsec之IP层安全架构
                </a>
            </div>
        
    </nav>

  
</article>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Netkit Filesystem 定制和裁剪　| CyannyLive　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://www.cyanny.com/2013/11/16/netkit-filesystem-custom-cutting/';
            this.page.identifier = '2013/11/16/netkit-filesystem-custom-cutting/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//lgrcyanny.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2013/11/24/distributed-system-review-part1/" title="Pre: 分布式系统总结part1">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2013/11/13/ipsec-architecture/" title="Next: IPsec之IP层安全架构">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/21/bineary-search-algorithm/">I look down on bineary search algorithm</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/22/booklist-for-2017/">My Booklist and Reservations for 2017</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/07/scala-collections/">Scala Collections</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/27/春江花月夜/">春江花月夜</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/27/eight-queens-problem-in-scala/">Eight Queens Problem In Scala</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/17/machine-learning-neural-networks/">Machine Learning Neural Networks</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/10/machine-learning-logistic-regression/">Machine Learning Logistic Regression</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/04/machine-learning-linear-regression/">Machine Learning Linear Regression</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/06/programming-in-scala-overview-key-note/">Programming In Scala Overview Key Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/07/learning-akka/">Learning Akka</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/04/bitsort-ant-qsort/">位排序和快排</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/04/03/find-median-for-two-sorted-array/">查找两个排序数组的中位数</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/08/16/hive-architecture/">Hive架构笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/12/dijkstra-algorithm-in-java/">Dijkstra Algorithm</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/20/hbase-mapreduce-e6-8e-92-e5-ba-8f-secondary-sort/">HBase MapReduce排序Secondary Sort</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/13/hbase-architecture-analysis-part-3-pros-cons/">HBase Architecture Analysis Part 3 Pros and Cons</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/13/hbase-architecture-analysis-part2-process-architecture/">HBase Architecture Analysis Part2(Process Architecture)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/13/hbase-architecture-analysis-part1-logical-architecture/">HBase Architecture Analysis Part1(Logical Architecture)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/02/27/nodejs-hbase-hadoop2-thrift2-e9-85-8d-e7-bd-ae-e4-b8-8e-e4-bd-bf-e7-94-a8/">Nodejs HBase0.96 Hadoop2.2.0 Thrift2配置与使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/02/27/revolution-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e7-9c-8b-e9-bb-91-e5-ae-a2-e5-b8-9d-e5-9b-bd/">Revolution——面向对象看黑客帝国</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/02/06/set-hadoop-hbase-part2/">Set up Hadoop 2.2 and HBase 0.96 part2</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/02/06/set-hadoop-hbase-part1/">Set up Hadoop 2.2 and HBase 0.96 part1</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/18/node-express-mysql-scaffolding/">Node Express Mysql Scaffolding</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-isnt-silver-bullet/">Hadoop isn’t Silver Bullet</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-mapreduce-2-yarn/">Hadoop MapReduce 2 (YARN)</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-mapreduce-1-framework/">Hadoop MapReduce 1 Framework</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-mapreduce-overview/">Hadoop MapReduce Overview</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-hdfs-high-availability/">Hadoop HDFS High Availability(HA)</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-hdfs-federation/">Hadoop HDFS Federation </a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-hdfs-review/">Hadoop HDFS Review</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/05/hadoop-overview/">Hadoop Overview</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/12/02/graph-dfs-bfs/">Graph DFS and BFS</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/27/system-analysis-design-kenneth-kendall-review-part4/">System Analysis and Design (Kenneth Kendall) Review Part4</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/27/system-analysis-design-kenneth-kendall-review-part3/">System Analysis and Design (Kenneth Kendall) Review Part3</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/27/system-analysis-design-kenneth-kendall-review-part2/">System Analysis and Design (Kenneth Kendall) Review Part2</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/27/system-analysis-design-kenneth-kendall-review-part1/">System Analysis and Design (Kenneth Kendall) Review Part1</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/24/distributed-system-review-part4/">分布式系统总结part4</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/24/distributed-system-review-part3/">分布式系统总结part3</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/24/distributed-system-review-part2/">分布式系统总结part2</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/24/distributed-system-review-part1/">分布式系统总结part1</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/16/netkit-filesystem-custom-cutting/">Netkit Filesystem 定制和裁剪</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/13/ipsec-architecture/">IPsec之IP层安全架构</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/11/how-to-set-up-vps-and-deploy-wordpress-blog-1/">如何配置VPS并发布WordPress Blog?(第一篇)</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/11/how-to-set-up-vps-and-deploy-wordpress-blog-2/">如何配置VPS并发布WordPress Blog?(第二篇)</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/10/how-to-start-learning-node-js/">How to start learning Node.js</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/11/01/agile-advantages-and-disadvantages/">“吐槽”敏捷软件开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/10/06/talk-about-open-source-software/">谈谈开源软件，谈谈质量</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/10/03/e7-bb-9f-e8-ae-a1-e5-ad-a6-e7-9a-84-e5-9f-ba-e6-9c-ac-e6-a6-82-e5-bf-b5-e5-92-8c-e6-96-b9-e6-b3-95/">统计学的基本概念和方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/09/12/select-second-smallest-element/">找一个数组中第2小的元素</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/09/09/warshall-algorithm-cycle-dectection/">Warshall's Algorithm for Cycle Dectection</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/08/18/the-usage-of-counting-sort/">计数排序的应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/08/10/learning-heap-sort/">再叙堆排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2013/05/25/good-resources-for-js-learning/">Good Resources for JavaScript</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i>
                2016-2017 Cyanny Liang
            </div>
            <div class="footer-right">
                <a>Best wishes for everyday~</a>
            </div>
        </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 2;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-40624708-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
             title: "a.article-title, .article-more-link a", 
             post: ".article-entry a[href], .copyright a[href]", 
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>