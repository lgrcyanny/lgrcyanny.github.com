<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Strucutre Learning Algorithm NOTEARS | CyannyLive | AI and Big Data</title>

  
  <meta name="author" content="Cyanny Liang">
  

  
  <meta name="description" content="Wisdom comes from inside">
  

  
  
  <meta name="keywords" content="Causal Inference, AI">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="Strucutre Learning Algorithm NOTEARS"/>

  <meta property="og:site_name" content="CyannyLive"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="CyannyLive" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">CyannyLive</a>
    </h1>
    <p class="site-description">AI and Big Data</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/about/">About</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>Strucutre Learning Algorithm NOTEARS</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2020/12/25/strucutre-learning-algorithm-notears/" rel="bookmark">
        <time class="entry-date published" datetime="2020-12-25T14:01:59.000Z">
          2020-12-25
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>最近三年扎进了AI领域, 学了很多算法, 最近开始真正拉高维度看AI, AI不仅仅是Machine Learning, 还有State Based, Variable Bases, Logic编程等方法. 最近半年看了<strong>The book of Why</strong>, 深受启发, 看世界的角度也发生很大变化, 同时也觉得因果推理将是一个值得研究的好领域, 就算目前落地场景不多, 相信未来也是大有可为.</p>
<p>今天静下来, 好好看了在CausalNex库中, 用到的算法NOTEARS, 用于结构学习, 该论文发表在2018的NIPS, 方法神奇, 解决方案简洁, 以下是自己的一些笔记:</p>
<p>Paper: Zheng, Xun, et al. “DAGs with NO TEARS: Continuous optimization for structure learning.” Advances in Neural Information Processing Systems 31 (2018): 9472-9483.</p>
<a id="more"></a>

<h1 id="1-主要问题"><a href="#1-主要问题" class="headerlink" title="1.主要问题"></a>1.主要问题</h1><p>Bayesian Network Graph(DAG) Structure Estimating, 这是一个经典的NP-HARD问题</p>
<table>
<thead>
<tr>
<th align="left">维度</th>
<th align="left">传统解法</th>
<th align="left">NOTEARS</th>
</tr>
</thead>
<tbody><tr>
<td align="left">思路</td>
<td align="left">combinatorial optimization problem, local heuristics for enforcing the acyclicity constraint, 例如 Order search, greedy search, …</td>
<td align="left">Score based continuous learning, standard numerical algorithm</td>
</tr>
<tr>
<td align="left">复杂度</td>
<td align="left">O(d!), d is nodes</td>
<td align="left">O(d^3), 当图入度很高时, 计算效率很高</td>
</tr>
<tr>
<td align="left">优势</td>
<td align="left">–</td>
<td align="left">支持有向和无向图, 代码简洁不超过60lines, 与Global Optimization算法结果接近</td>
</tr>
<tr>
<td align="left">局限</td>
<td align="left">困难的组合优化问题</td>
<td align="left">建模函数是Smooth function, nonconvex</td>
</tr>
</tbody></table>
<h1 id="2-NOTEARS算法"><a href="#2-NOTEARS算法" class="headerlink" title="2.NOTEARS算法"></a>2.NOTEARS算法</h1><p>其英文缩写是 Non-combinatorial Optimization via Trace Exponential and Augmented lagRangian for Structure learning<br>该算法我个人理解主要的贡献是找到一种数学建模方法, 把DAG的学习问题转化为可以用拉格朗日乘数法可求最优解的问题, 其建模的问题定义如下:</p>
<p><img src="https://wx4.sinaimg.cn/mw690/761b7938ly1gm0h7k87gij21hl0kpdm0.jpg" alt="model def"></p>
<p>基于拉格朗日乘数法进行数值优化, 优势是:一个有n个变量与k个约束条件的最优化问题转换为一个解有n + k个变量的方程组的解的问题, 同时可复用一些优化算法: L-BFGS, quasi-Newton(PQN)</p>
<ul>
<li>例如: 求f(x, y)在g(x, y)=c约数下的最大值, 可以转化为求下面函数的极值的问题:</li>
<li>\(L(x, y, \gamma) = f(x, y) + \gamma * (g(x, y) - c)\)</li>
</ul>
<p>下图是NOTEARS抽象为拉格朗日乘数的公式</p>
<p><img src="https://wx4.sinaimg.cn/mw690/761b7938ly1gm0h7pxt34j21e6089abm.jpg" alt="lagrangian equation"></p>
<p>下图是NOTEARS的算法流程</p>
<p><img src="https://wx2.sinaimg.cn/mw690/761b7938ly1gm0h7tsn6lj20yu0bqgno.jpg" alt="notears algorithm"></p>
<h1 id="3-NOTEARS算法效果"><a href="#3-NOTEARS算法效果" class="headerlink" title="3.NOTEARS算法效果"></a>3.NOTEARS算法效果</h1><p>作者从ERS, SF4中生成了Node数为20, 样本量为1000和20的数据集, 图表示是邻接矩阵, 可看到学习后的效果和true graph很接近, 效果比Fast Greedy Search(FGS)要好, 同时和Global Optimizer的结果很接近, 准确性好</p>
<p><img src="https://wx4.sinaimg.cn/mw690/761b7938ly1gm0h7xhnenj21et0mwqcw.jpg" alt="notears effect"></p>
<p>继续奋战, 下一波是Bayesian Network ^–^</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/causal-inference-ai/">Causal Inference, AI</a>
    </span>
    

    </div>

    
  </div>
</article>

  
	<section id="comments" class="comment">
	  <div id="disqus_thread">
	  <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	  </div>
	</section>

	<script type="text/javascript">
	var disqus_shortname = 'lgrcyanny';
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	</script>





    </main>

    <footer class="site-footer">
  <p class="site-info">
    Copyright
    </br>
    
    &copy; 2021 Cyanny Liang
    
  </p>
</footer>
    
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-40624708-1', 'auto');
    ga('send', 'pageview');

</script>

  </div>
</div>
</body>
</html>